{"version":3,"file":"9-BBmgVYYs.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(auth)/login/_page.server.ts.js","../../../.svelte-kit/adapter-node/nodes/9.js"],"sourcesContent":["import { signInWithEmailAndPassword } from \"firebase/auth\";\nimport { redirect, fail } from \"@sveltejs/kit\";\nimport { f as firebase } from \"../../../../chunks/firebase.js\";\nimport { getDocs, collection, doc, updateDoc } from \"firebase/firestore\";\nconst actions = {\n  login: async ({ fetch, request }) => {\n    const formData = await request.formData();\n    const email = formData.get(\"email\");\n    const password = formData.get(\"password\");\n    if (email === \"admin\" && password === \"admin\") {\n      const admin = { email, password };\n      await fetch(\"/api/session\", {\n        method: \"POST\",\n        credentials: \"same-origin\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(admin)\n      });\n      throw redirect(303, \"/admin\");\n    }\n    try {\n      const userInfo = await signInWithEmailAndPassword(firebase.auth, email, password);\n      const Users = (await getDocs(collection(firebase.db, \"Users\"))).docs;\n      const User = Users.find((dc) => dc.data().id === userInfo.user.uid);\n      if (!User) {\n        throw new Error(\"NO USER\");\n      }\n      const docRef = doc(firebase.db, \"Users\", User.id);\n      await updateDoc(docRef, {\n        lastLogin: (/* @__PURE__ */ new Date()).toDateString()\n      });\n      await fetch(\"/api/session\", {\n        method: \"POST\",\n        credentials: \"same-origin\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(userInfo)\n      });\n    } catch (err) {\n      return fail(400, err instanceof Error ? { error: err.message } : { error: \"Login failed\" });\n    }\n    throw redirect(303, \"/home\");\n  }\n};\nexport {\n  actions\n};\n","import * as server from '../entries/pages/(auth)/login/_page.server.ts.js';\n\nexport const index = 9;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/(auth)/login/_page.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/(auth)/login/+page.server.ts\";\nexport const imports = [\"_app/immutable/nodes/9.BP0T3OGO.js\",\"_app/immutable/chunks/DsnmJJEf.js\",\"_app/immutable/chunks/nGUMutCJ.js\",\"_app/immutable/chunks/BeycMaZk.js\",\"_app/immutable/chunks/CltT4Sjb.js\",\"_app/immutable/chunks/D6y1jbd9.js\",\"_app/immutable/chunks/AhqUU1ts.js\",\"_app/immutable/chunks/Bgbd2wj0.js\",\"_app/immutable/chunks/CStty2jV.js\",\"_app/immutable/chunks/CYgJF_JY.js\",\"_app/immutable/chunks/Dzlaz3fn.js\",\"_app/immutable/chunks/BrdxJ9sT.js\"];\nexport const stylesheets = [];\nexport const fonts = [];\n"],"names":[],"mappings":";;;;;;AAIA,MAAM,OAAO,GAAG;AAChB,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK;AACvC,IAAI,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,QAAQ,EAAE;AAC7C,IAAI,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC;AACvC,IAAI,MAAM,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC;AAC7C,IAAI,IAAI,KAAK,KAAK,OAAO,IAAI,QAAQ,KAAK,OAAO,EAAE;AACnD,MAAM,MAAM,KAAK,GAAG,EAAE,KAAK,EAAE,QAAQ,EAAE;AACvC,MAAM,MAAM,KAAK,CAAC,cAAc,EAAE;AAClC,QAAQ,MAAM,EAAE,MAAM;AACtB,QAAQ,WAAW,EAAE,aAAa;AAClC,QAAQ,OAAO,EAAE,EAAE,cAAc,EAAE,kBAAkB,EAAE;AACvD,QAAQ,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK;AAClC,OAAO,CAAC;AACR,MAAM,MAAM,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;AACnC,IAAI;AACJ,IAAI,IAAI;AACR,MAAM,MAAM,QAAQ,GAAG,MAAM,0BAA0B,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,QAAQ,CAAC;AACvF,MAAM,MAAM,KAAK,GAAG,CAAC,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE,IAAI;AAC1E,MAAM,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,KAAK,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC;AACzE,MAAM,IAAI,CAAC,IAAI,EAAE;AACjB,QAAQ,MAAM,IAAI,KAAK,CAAC,SAAS,CAAC;AAClC,MAAM;AACN,MAAM,MAAM,MAAM,GAAG,GAAG,CAAC,QAAQ,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC;AACvD,MAAM,MAAM,SAAS,CAAC,MAAM,EAAE;AAC9B,QAAQ,SAAS,EAAE,iBAAiB,IAAI,IAAI,EAAE,EAAE,YAAY;AAC5D,OAAO,CAAC;AACR,MAAM,MAAM,KAAK,CAAC,cAAc,EAAE;AAClC,QAAQ,MAAM,EAAE,MAAM;AACtB,QAAQ,WAAW,EAAE,aAAa;AAClC,QAAQ,OAAO,EAAE,EAAE,cAAc,EAAE,kBAAkB,EAAE;AACvD,QAAQ,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ;AACrC,OAAO,CAAC;AACR,IAAI,CAAC,CAAC,OAAO,GAAG,EAAE;AAClB,MAAM,OAAO,IAAI,CAAC,GAAG,EAAE,GAAG,YAAY,KAAK,GAAG,EAAE,KAAK,EAAE,GAAG,CAAC,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,cAAc,EAAE,CAAC;AACjG,IAAI;AACJ,IAAI,MAAM,QAAQ,CAAC,GAAG,EAAE,OAAO,CAAC;AAChC,EAAE;AACF,CAAC;;;;;;;ACvCW,MAAC,KAAK,GAAG;AACrB,IAAI,eAAe;AACP,MAAC,SAAS,GAAG,YAAY,eAAe,KAAK,CAAC,MAAM,OAAO,4BAA+C,CAAC,EAAE;AAE7G,MAAC,SAAS,GAAG;AACb,MAAC,OAAO,GAAG,CAAC,oCAAoC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC;AAC5b,MAAC,WAAW,GAAG;AACf,MAAC,KAAK,GAAG;;;;"}