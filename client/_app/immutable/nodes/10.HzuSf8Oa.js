import"../chunks/DsnmJJEf.js";import{p as te,h as b,a as re,f as y,s as i,$ as pe,d as o,t as J,i as t,b as _,c as ae,j as a,ar as be,r as s,g as ge,n as xe,a0 as _e}from"../chunks/hMZFjhjB.js";import{d as he,r as ye,s as A}from"../chunks/C3vF11sT.js";import{i as F}from"../chunks/DO9TSQkw.js";import{p as B}from"../chunks/CWuZaM_Z.js";import{o as we}from"../chunks/DL7c-2PW.js";import{e as ke,i as je}from"../chunks/DnkpmdWb.js";import{a as Me,b as S,e as Ce}from"../chunks/CG3erNDF.js";import{r as E}from"../chunks/2gOuTNXT.js";import{b as Be}from"../chunks/WF52vTBT.js";import"../chunks/CrL3HiYF.js";import{M as Se}from"../chunks/6qdKIYlW.js";function Ae(v){return new Promise((d,l)=>{const c=new FileReader;c.readAsDataURL(v),c.onload=()=>d(c.result),c.onerror=m=>l(m)})}function $e(v,d){const l=Array.from(v.target?.files||[]);d(l)}function Ee(v,d,l,c,m,f,g,u,p){confirm("Are you sure you want to cancel? All data will be lost.")&&(a(d,""),a(l,""),a(c,""),a(m,""),a(f,""),a(g,[],!0),a(u,!1),a(p,{to:t(d),subject:t(m),message:t(f)}))}var Fe=(v,d)=>a(d,!0),ze=y('<button type="button" class="text-sm font-medium text-blue-600 hover:text-blue-800">+ Add CC/BCC</button>'),Te=y('<div class="grid grid-cols-1 gap-4 md:grid-cols-2"><div><label for="cc-email" class="mb-2 block text-sm font-medium text-gray-700">CC</label> <input id="cc-email" type="email" placeholder="cc@example.com" class="w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label for="bcc-email" class="mb-2 block text-sm font-medium text-gray-700">BCC</label> <input id="bcc-email" type="email" placeholder="bcc@example.com" class="w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500"/></div></div>'),Re=(v,d,l)=>d(t(l).id),Oe=y('<div class="file-item flex items-center justify-between rounded-lg bg-gray-50 svelte-1qutyk1"><div class="flex items-center justify-center gap-1"><div><p class="font-medium text-gray-900"> </p> <p class="text-sm text-gray-500"> </p></div></div> <button type="button" class="font-medium text-red-500 hover:text-red-700">âœ•</button></div>'),Pe=y('<div class="space-y-2"></div>'),Ge=y('<div class="flex items-center justify-center"><div class="flex w-[300px] flex-col items-center justify-center"><form class="flex flex-col items-center gap-1 rounded-lg bg-white p-5 shadow-lg" method="POST" action="?/sendEmail"><div class="flex items-center justify-between gap-4"><label for="sender-mail" class="block text-sm font-medium text-gray-700">To</label> <input id="sender-mail" type="email" placeholder="recipient@example.com" class="w-full rounded-md border border-gray-300 focus:border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <!> <!> <div><label for="subject" class="mb-2 block text-sm font-medium text-gray-700">Subject <span class="text-red-500">*</span></label> <input id="subject" type="text" placeholder="Enter email subject" class="w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label for="message" class="mb-2 block text-sm font-medium text-gray-700">Message <span class="text-red-500">*</span></label> <textarea id="message" rows="6" placeholder="Enter your message here..." class="w-full resize-y rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea></div> <div class="flex flex-col items-center gap-2"><label for="files" class="mb-2 block text-sm font-medium text-gray-700">Attachments</label> <input id="files" type="file" multiple class="hidden"/> <!> <div class="text-sm text-gray-500"> </div></div> <div class="flex flex-col items-center justify-between"><div class="flex gap-3"><button type="button" class="rounded-md border border-gray-300 font-medium text-gray-700 transition-colors hover:bg-gray-50">Cancel</button> <button type="submit" class="h-[30px] w-[100px] transform rounded-md bg-blue-600 font-medium text-white transition-all hover:scale-105 hover:from-blue-700 hover:to-purple-700 disabled:transform-none disabled:cursor-not-allowed disabled:opacity-50"> </button></div></div></form></div></div>');function Ie(v,d){te(d,!0);let l=b("a.mussari@studenti.unipi.it"),c=b(""),m=b(""),f=b("TEST"),g=b("TESTING"),u=b(re([])),p=b(!1),M=b(!1),h=pe(()=>({to:t(l),subject:t(f),message:t(g)})),C=b(void 0);function $(e){if(e===0)return"0 Bytes";const r=1024,n=["Bytes","KB","MB","GB"],x=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,x)).toFixed(2))+" "+n[x]}function se(e){const r=e.map(n=>({id:Date.now()+Math.random(),file:n,name:n.name,size:n.size,type:n.type}));a(u,[...t(u),...r],!0)}function oe(e){a(u,t(u).filter(r=>r.id!==e),!0)}we(()=>{be("App")});var z=Ge(),K=o(z),T=o(K),R=o(T),L=i(o(R),2);E(L),s(R);var U=i(R,2);{var ie=e=>{var r=ze();r.__click=[Fe,M],_(e,r)};F(U,e=>{t(M)||e(ie)})}var H=i(U,2);{var le=e=>{var r=Te(),n=o(r),x=i(o(n),2);E(x),s(n);var w=i(n,2),k=i(o(w),2);E(k),s(w),s(r),S(x,()=>t(c),j=>a(c,j)),S(k,()=>t(m),j=>a(m,j)),_(e,r)};F(H,e=>{t(M)&&e(le)})}var O=i(H,2),Q=i(o(O),2);E(Q),s(O);var P=i(O,2),V=i(o(P),2);ye(V),s(P);var G=i(P,2),I=i(o(G),2);I.__change=[$e,se],Be(I,e=>a(C,e),()=>t(C));var W=i(I,2);{var ne=e=>{var r=Pe();ke(r,21,()=>t(u),je,(n,x)=>{var w=Oe(),k=o(w),j=o(k),q=o(j),ue=o(q,!0);s(q);var ee=i(q,2),me=o(ee,!0);s(ee),s(j),s(k);var fe=i(k,2);fe.__click=[Re,oe,x],s(w),J(ve=>{A(ue,t(x).name),A(me,ve)},[()=>$(t(x).size)]),_(n,w)}),s(r),_(e,r)};F(W,e=>{t(u).length>0&&e(ne)})}var X=i(W,2),de=o(X);s(X),s(G);var Y=i(G,2),Z=o(Y),D=o(Z);D.__click=[Ee,l,c,m,f,g,u,M,h];var N=i(D,2),ce=o(N,!0);s(N),s(Z),s(Y),s(T),Me(T,(e,r)=>Ce?.(e,r),()=>async({formData:e})=>{a(p,!0),e.set("to",t(l)),e.set("subject",t(f)),e.set("message",t(g));for(const r of t(u)){const n=(await Ae(r.file)).split(",")[1];e.append("attachments",JSON.stringify({name:r.name,content:n}))}return async({result:r,update:n})=>{a(p,!1),r.type==="success"?await n():r.type==="failure"&&await n()}}),s(K),s(z),J(()=>{A(de,`${t(u).length??""} file(s) attached`),N.disabled=t(p),A(ce,t(p)?"Sending...":"Send Email")}),S(L,()=>t(l),e=>a(l,e)),S(Q,()=>t(f),e=>a(f,e)),S(V,()=>t(g),e=>a(g,e)),_(v,z),ae()}he(["click","change"]);var Ne=y("<h2>ERROR</h2>"),qe=y("<!> <!>",1);function et(v,d){te(d,!0);let l=b(!1),c=re(B.error!==null||B.form&&B.form.error);c&&a(l,!0);var m=qe(),f=ge(m);Ie(f,{});var g=i(f,2);{var u=p=>{Se(p,{get showModal(){return t(l)},set showModal(h){a(l,h,!0)},header:h=>{var C=Ne();_(h,C)},children:(h,C)=>{xe();var $=_e();J(()=>A($,B.error?.message||B.form.error.message)),_(h,$)},$$slots:{header:!0,default:!0}})};F(g,p=>{c&&p(u)})}_(v,m),ae()}export{et as component};
