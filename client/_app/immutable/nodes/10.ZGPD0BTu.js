import"../chunks/DsnmJJEf.js";import{p as oe,j as g,a as K,f as y,i as le,s as l,a1 as se,d as i,t as F,k as t,b as x,c as ie,l as s,r as o,n as ne,a2 as de}from"../chunks/D50pdiVl.js";import{d as je,r as $e,s as $}from"../chunks/BExVpiIy.js";import{i as A}from"../chunks/CIBJ9sE4.js";import{p as S}from"../chunks/CEylPTDC.js";import{e as Ce,i as Be}from"../chunks/Bvhg8_Rw.js";import{a as Se,b as E,e as Ee}from"../chunks/BOUJ1jSm.js";import{r as R}from"../chunks/pAYp49zD.js";import{b as Ae}from"../chunks/CarLpTOU.js";import"../chunks/CrL3HiYF.js";import{M as ce}from"../chunks/Dbvaylpg.js";function Re(p){return new Promise((d,n)=>{const c=new FileReader;c.readAsDataURL(p),c.onload=()=>d(c.result),c.onerror=f=>n(f)})}function Fe(p,d){const n=Array.from(p.target?.files||[]);d(n)}function ze(p,d,n,c,f,v,_,u,b){confirm("Are you sure you want to cancel? All data will be lost.")&&(s(d,""),s(n,""),s(c,""),s(f,""),s(v,""),s(_,[],!0),s(u,!1),s(b,{to:t(d),subject:t(f),message:t(v)}))}var Te=(p,d)=>s(d,!0),Oe=y('<button type="button" class="text-sm font-medium text-blue-600 hover:text-blue-800">+ Add CC/BCC</button>'),Pe=y('<div class="grid grid-cols-1 gap-4 md:grid-cols-2"><div><label for="cc-email" class="mb-2 block text-sm font-medium text-gray-700">CC</label> <input id="cc-email" type="email" placeholder="cc@example.com" class="w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"/></div> <div><label for="bcc-email" class="mb-2 block text-sm font-medium text-gray-700">BCC</label> <input id="bcc-email" type="email" placeholder="bcc@example.com" class="w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"/></div></div>'),Ge=(p,d,n)=>d(t(n).id),Ie=y('<div class="file-item flex items-center justify-between rounded-lg bg-gray-50 svelte-1qutyk1"><div class="flex items-center justify-center gap-1"><div><p class="font-medium text-gray-900"> </p> <p class="text-sm text-gray-500"> </p></div></div> <button type="button" class="font-medium text-red-500 hover:text-red-700">âœ•</button></div>'),Ne=y('<div class="space-y-2"></div>'),qe=y("<h2>ERROR</h2>"),Je=y('<div class="flex items-center justify-center"><div class="flex w-[300px] flex-col items-center justify-center"><form class="flex flex-col items-center gap-1 rounded-lg bg-white p-5 shadow-lg" method="POST" action="?/sendEmail"><div class="flex items-center justify-between gap-4"><label for="sender-mail" class="block text-sm font-medium text-gray-700">To</label> <input id="sender-mail" type="email" placeholder="recipient@example.com" class="w-full rounded-md border border-gray-300 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"/></div> <!> <!> <div><label for="subject" class="mb-2 block text-sm font-medium text-gray-700">Subject <span class="text-red-500">*</span></label> <input id="subject" type="text" placeholder="Enter email subject" class="w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"/></div> <div><label for="message" class="mb-2 block text-sm font-medium text-gray-700">Message <span class="text-red-500">*</span></label> <textarea id="message" rows="6" placeholder="Enter your message here..." class="w-full resize-y rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"></textarea></div> <div class="flex flex-col items-center gap-2"><label for="files" class="mb-2 block text-sm font-medium text-gray-700">Attachments</label> <input id="files" type="file" multiple class="hidden"/> <!> <div class="text-sm text-gray-500"> </div></div> <div class="flex flex-col items-center justify-between"><div class="flex gap-3"><button type="button" class="rounded-md border border-gray-300 font-medium text-gray-700 transition-colors hover:bg-gray-50">Cancel</button> <button type="submit" class="h-[30px] w-[100px] transform rounded-md bg-blue-600 font-medium text-white transition-all hover:scale-105 hover:from-blue-700 hover:to-purple-700 disabled:transform-none disabled:cursor-not-allowed disabled:opacity-50"> </button></div></div></form></div></div> <!>',1);function Ke(p,d){oe(d,!0);let n=g("a.mussari@studenti.unipi.it"),c=g(""),f=g(""),v=g("TEST"),_=g("TESTING"),u=g(K([])),b=g(!1),C=g(!1),w=se(()=>({to:t(n),subject:t(v),message:t(_)})),B=g(void 0),k=K({value:""}),L=se(()=>k.value.length>0);function ue(e){if(e===0)return"0 Bytes";const r=1024,a=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,m)).toFixed(2))+" "+a[m]}function me(e){const r=e.map(a=>({id:Date.now()+Math.random(),file:a,name:a.name,size:a.size,type:a.type}));s(u,[...t(u),...r],!0)}function fe(e){s(u,t(u).filter(r=>r.id!==e),!0)}var U=Je(),z=le(U),H=i(z),T=i(H),O=i(T),Q=l(i(O),2);R(Q),o(O);var V=l(O,2);{var ve=e=>{var r=Oe();r.__click=[Te,C],x(e,r)};A(V,e=>{t(C)||e(ve)})}var W=l(V,2);{var pe=e=>{var r=Pe(),a=i(r),m=l(i(a),2);R(m),o(a);var h=l(a,2),M=l(i(h),2);R(M),o(h),o(r),E(m,()=>t(c),j=>s(c,j)),E(M,()=>t(f),j=>s(f,j)),x(e,r)};A(W,e=>{t(C)&&e(pe)})}var P=l(W,2),X=l(i(P),2);R(X),o(P);var G=l(P,2),Y=l(i(G),2);$e(Y),o(G);var I=l(G,2),N=l(i(I),2);N.__change=[Fe,me],Ae(N,e=>s(B,e),()=>t(B));var Z=l(N,2);{var be=e=>{var r=Ne();Ce(r,21,()=>t(u),Be,(a,m)=>{var h=Ie(),M=i(h),j=i(M),J=i(j),ye=i(J,!0);o(J);var ae=l(J,2),we=i(ae,!0);o(ae),o(j),o(M);var ke=l(M,2);ke.__click=[Ge,fe,m],o(h),F(Me=>{$(ye,t(m).name),$(we,Me)},[()=>ue(t(m).size)]),x(a,h)}),o(r),x(e,r)};A(Z,e=>{t(u).length>0&&e(be)})}var D=l(Z,2),ge=i(D);o(D),o(I);var ee=l(I,2),te=i(ee),re=i(te);re.__click=[ze,n,c,f,v,_,u,C,w];var q=l(re,2),xe=i(q,!0);o(q),o(te),o(ee),o(T),Se(T,(e,r)=>Ee?.(e,r),()=>async({formData:e})=>{s(b,!0),e.set("to",t(n)),e.set("subject",t(v)),e.set("message",t(_));for(const r of t(u)){const a=(await Re(r.file)).split(",")[1];e.append("attachments",JSON.stringify({name:r.name,content:a}))}return async({result:r,update:a})=>{s(b,!1),r.type==="success"?await a():r.type==="failure"&&(console.error(r.data),k.value=r.data?.message,await a())}}),o(H),o(z);var _e=l(z,2);{var he=e=>{ce(e,{get showModal(){return t(L)},set showModal(a){s(L,a)},header:a=>{var m=qe();x(a,m)},children:(a,m)=>{ne();var h=de();F(()=>$(h,k.value)),x(a,h)},$$slots:{header:!0,default:!0}})};A(_e,e=>{k.value.length>0&&e(he)})}F(()=>{$(ge,`${t(u).length??""} file(s) attached`),q.disabled=t(b),$(xe,t(b)?"Sending...":"Send Email")}),E(Q,()=>t(n),e=>s(n,e)),E(X,()=>t(v),e=>s(v,e)),E(Y,()=>t(_),e=>s(_,e)),x(p,U),ie()}je(["click","change"]);var Le=y("<h2>ERROR</h2>"),Ue=y("<!> <!>",1);function at(p,d){oe(d,!0);let n=g(!1),c=K(S.error!==null||S.form&&S.form.error);c&&s(n,!0);var f=Ue(),v=le(f);Ke(v,{});var _=l(v,2);{var u=b=>{ce(b,{get showModal(){return t(n)},set showModal(w){s(n,w,!0)},header:w=>{var B=Le();x(w,B)},children:(w,B)=>{ne();var k=de();F(()=>$(k,S.error?.message||S.form.error.message)),x(w,k)},$$slots:{header:!0,default:!0}})};A(_,b=>{c&&b(u)})}x(p,f),ie()}export{at as component};
