import"../chunks/DsnmJJEf.js";import{p as D,h as v,a as N,f as w,b as ee,s as i,$ as Y,e as d,t as E,i as t,c as g,d as te,j as r,r as l,n as re,a0 as ae}from"../chunks/CB0GAoS5.js";import{d as pe,r as be,s as M}from"../chunks/DuTLVp-_.js";import{i as q}from"../chunks/BKAMBxZp.js";import{p as k}from"../chunks/CXKqNFy3.js";import{e as he,i as ge}from"../chunks/CdrGPqyf.js";import{a as xe,b as I,e as _e}from"../chunks/B9xabBUp.js";import{r as Z}from"../chunks/CH-7nw50.js";import{b as ye}from"../chunks/BTZEZ-Wa.js";import"../chunks/CrL3HiYF.js";import"../chunks/KjYeVjkE.js";import{M as se}from"../chunks/CaL4QoSf.js";function we(p){return new Promise((c,s)=>{const u=new FileReader;u.readAsDataURL(p),u.onload=()=>c(u.result),u.onerror=b=>s(b)})}function je(p,c){const s=Array.from(p.target?.files||[]);c(s)}function $e(p,c,s,u,b,m,h,n,f){confirm("Are you sure you want to cancel? All data will be lost.")&&(r(c,""),r(s,""),r(u,""),r(b,""),r(m,""),r(h,[],!0),r(n,!1),r(f,{to:t(c),subject:t(b),message:t(m)}))}var ke=(p,c,s)=>c(t(s).id),Me=w('<div class="file-item flex items-center justify-between rounded-lg bg-gray-50 svelte-1qutyk1"><p class="font-medium text-gray-900"> </p> <button type="button" class="font-medium text-red-500 hover:text-red-700">âœ•</button></div>'),Ee=w('<div class="space-y-2"></div>'),Se=w("<h2>ERROR</h2>"),Re=w('<div class="flex items-center justify-center"><div class="flex w-[300px] flex-col items-center justify-center"><form class="flex max-h-[500px] flex-col items-center gap-1 rounded-lg bg-white p-5 shadow-lg" method="POST" action="?/sendEmail"><div class="flex items-center justify-between gap-4"><label for="sender-mail" class="block text-sm font-medium text-gray-700">To</label> <input id="sender-mail" type="email" placeholder="recipient@example.com" class=" w-full rounded-md border border-gray-300 text-center focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"/></div> <div><label for="subject" class="mb-2 block text-sm font-medium text-gray-700">Subject <span class="text-red-500">*</span></label> <input id="subject" type="text" placeholder="Enter email subject" class="w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"/></div> <div><label for="message" class="mb-2 block text-sm font-medium text-gray-700">Message <span class="text-red-500">*</span></label> <textarea id="message" rows="6" placeholder="Enter your message here..." class="w-full resize-y rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"></textarea></div> <div class="flex flex-col items-center gap-2 overflow-y-scroll"><label for="files" class="mb-2 block text-sm font-medium text-gray-700">Attachments</label> <input id="files" type="file" multiple class="hidden"/> <!></div> <div class="text-sm text-gray-500"> </div> <div class="flex flex-col items-center justify-between"><div class="flex gap-3"><button type="button" class="rounded-md border border-gray-300 font-medium text-gray-700 transition-colors hover:bg-gray-50">Cancel</button> <button type="submit" class="h-[30px] w-[100px] transform rounded-md bg-blue-600 font-medium text-white transition-all hover:scale-105 hover:from-blue-700 hover:to-purple-700 disabled:transform-none disabled:cursor-not-allowed disabled:opacity-50"> </button></div></div></form></div></div> <!>',1);function Ae(p,c){D(c,!0);let s=v("a.mussari@studenti.unipi.it"),u=v(""),b=v(""),m=v("TEST"),h=v("TESTING"),n=v(N([])),f=v(!1),G=v(!1),x=Y(()=>({to:t(s),subject:t(m),message:t(h)})),j=v(void 0),_=N({value:""}),J=Y(()=>_.value.length>0);function oe(e){const a=e.map(o=>({id:Date.now()+Math.random(),file:o,name:o.name,size:o.size,type:o.type}));r(n,[...t(n),...a],!0)}function le(e){r(n,t(n).filter(a=>a.id!==e),!0)}var L=Re(),S=ee(L),U=d(S),R=d(U),A=d(R),H=i(d(A),2);Z(H),l(A);var T=i(A,2),K=i(d(T),2);Z(K),l(T);var F=i(T,2),Q=i(d(F),2);be(Q),l(F);var O=i(F,2),P=i(d(O),2);P.__change=[je,oe],ye(P,e=>r(j,e),()=>t(j));var ie=i(P,2);{var ne=e=>{var a=Ee();he(a,21,()=>t(n),ge,(o,$)=>{var y=Me(),C=d(y),fe=d(C,!0);l(C);var ve=i(C,2);ve.__click=[ke,le,$],l(y),E(()=>M(fe,t($).name)),g(o,y)}),l(a),g(e,a)};q(ie,e=>{t(n).length>0&&e(ne)})}l(O);var z=i(O,2),de=d(z);l(z);var V=i(z,2),W=d(V),X=d(W);X.__click=[$e,s,u,b,m,h,n,G,x];var B=i(X,2),ce=d(B,!0);l(B),l(W),l(V),l(R),xe(R,(e,a)=>_e?.(e,a),()=>async({formData:e})=>{r(f,!0),e.set("to",t(s)),e.set("subject",t(m)),e.set("message",t(h));for(const a of t(n)){const o=(await we(a.file)).split(",")[1];e.append("attachments",JSON.stringify({name:a.name,content:o}))}return async({result:a,update:o})=>{r(f,!1),a.type==="success"?await o():a.type==="failure"&&(console.error(a.data),_.value=a.data?.message,await o())}}),l(U),l(S);var ue=i(S,2);{var me=e=>{se(e,{get showModal(){return t(J)},set showModal(o){r(J,o)},header:o=>{var $=Se();g(o,$)},children:(o,$)=>{re();var y=ae();E(()=>M(y,_.value)),g(o,y)},$$slots:{header:!0,default:!0}})};q(ue,e=>{_.value.length>0&&e(me)})}E(()=>{M(de,`${t(n).length??""} file(s) attached`),B.disabled=t(f),M(ce,t(f)?"Sending...":"Send Email")}),I(H,()=>t(s),e=>r(s,e)),I(K,()=>t(m),e=>r(m,e)),I(Q,()=>t(h),e=>r(h,e)),g(p,L),te()}pe(["change","click"]);var Te=w("<h2>ERROR</h2>"),Fe=w("<!> <!>",1);function He(p,c){D(c,!0);let s=v(!1),u=N(k.error!==null||k.form&&k.form.error);u&&r(s,!0);var b=Fe(),m=ee(b);Ae(m,{});var h=i(m,2);{var n=f=>{se(f,{get showModal(){return t(s)},set showModal(x){r(s,x,!0)},header:x=>{var j=Te();g(x,j)},children:(x,j)=>{re();var _=ae();E(()=>M(_,k.error?.message||k.form.error.message)),g(x,_)},$$slots:{header:!0,default:!0}})};q(h,f=>{u&&f(n)})}g(p,b),te()}export{He as component};
